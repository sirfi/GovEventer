function selectFile(n){$("#pnlFileList li").removeClass("selected");$(n).prop("class","selected");var i=RoxyUtils.GetFilename($(n).attr("data-path"));i+=" ("+t("Size")+": "+RoxyUtils.FormatFileSize($(n).attr("data-size"));$(n).attr("data-w")>0&&(i+=", "+t("Dimensions")+":"+$(n).attr("data-w")+"x"+$(n).attr("data-h"));i+=")";$("#pnlStatus").html(i)}function selectDir(n){var t=Directory.Parse($(n).parent("li").attr("data-path"));t&&t.Select()}function startDragDir(){}function startDragFile(){selectFile(this)}function dragFileOver(){$(this).children("img.dir").attr("src","images/folder-green.png")}function dragFileOut(){$("#pnlDirList").find("img.dir").attr("src","images/folder.png")}function makeDragFile(n){var t=new File($(n.target).closest("li").attr("data-path"));return'<div class="pnlDragFile" data-path="'+t.fullPath+'"><img src="'+t.bigIcon+'" align="absmiddle">&nbsp;'+t.name+"<\/div>"}function makeDragDir(n){var t=new Directory($(n.target).attr("data-path")?$(n.target).attr("data-path"):$(n.target).closest("li").attr("data-path"));return'<div class="pnlDragDir" data-path="'+t.fullPath+'"><img src="images/folder.png" align="absmiddle">&nbsp;'+t.name+"<\/div>"}function moveDir(n,t,i){var r=Directory.Parse(t.draggable.attr("data-path")),u=Directory.Parse($(i).parent("li").attr("data-path"));u.fullPath!=r.path&&r.Move(u.fullPath)}function moveFile(n,t,i){var r=new File(t.draggable.attr("data-path")),u=Directory.Parse($(i).parent("li").attr("data-path")),f=Directory.Parse(r.path);r.path!=u.fullPath&&r.Move(u.fullPath)}function moveObject(n,t){n.stopPropagation();t.draggable.hasClass("directory")?moveDir(n,t,this):moveFile(n,t,this);dragFileOut()}function clickFirstOnEnter(n){$("#"+n).unbind("keypress");$(".actions input").each(function(){this.blur()});$("#"+n).keypress(function(n){n.keyCode==$.ui.keyCode.ENTER&&(n.stopPropagation(),$(this).parent().find(".ui-dialog-buttonset button").eq(0).trigger("click"))})}function addDir(){var i=getSelectedDir(),n;i&&(clickFirstOnEnter("pnlDirName"),$("#txtDirName").val(""),n={},n[t("CreateDir")]=function(){var n=$.trim($("#txtDirName").val());n||alert(t("E_MissingDirName"));i.Create(n)&&$("#pnlDirName").dialog("close")},n[t("Cancel")]=function(){$("#pnlDirName").dialog("close")},$("#pnlDirName").dialog({title:t("T_CreateDir"),modal:!0,buttons:n}))}function addFile(){clickFirstOnEnter("dlgAddFile");var n={};n[t("Upload")]=function(){$("#fileUploads").val()?RoxyFilemanConf.UPLOAD?(document.forms.addfile.action=RoxyFilemanConf.UPLOAD,document.forms.addfile.submit()):alert(t("E_ActionDisabled")):alert(t("E_SelectFiles"))};n[t("Cancel")]=function(){$("#dlgAddFile").dialog("close")};$("#dlgAddFile").dialog({title:t("T_AddFile"),modal:!0,buttons:n})}function fileUploaded(n){var t;n.res=="ok"&&n.msg?($("#dlgAddFile").dialog("close"),t=Directory.Parse($("#hdDir").val()),t.ListFiles(!0),alert(n.msg)):n.res=="ok"?($("#dlgAddFile").dialog("close"),t=Directory.Parse($("#hdDir").val()),t.ListFiles(!0)):alert(n.msg)}function renameDir(){var n=getSelectedDir(),i;if(n){if($('[data-path="'+n.fullPath+'"]').parents("li").length<1){alert(t("E_CannotRenameRoot"));return}clickFirstOnEnter("pnlDirName");$("#txtDirName").val(n.name);i={};i[t("Rename")]=function(){var i=$.trim($("#txtDirName").val());i||alert(t("E_MissingDirName"));n.Rename(i)&&$("#pnlDirName").dialog("close")};i[t("Cancel")]=function(){$("#pnlDirName").dialog("close")};$("#pnlDirName").dialog({title:t("T_RenameDir"),modal:!0,buttons:i});RoxyUtils.SelectText("txtDirName",0,new String(n.name).length)}}function renameFile(){var n=getSelectedFile(),i;n&&(clickFirstOnEnter("pnlRenameFile"),$("#txtFileName").val(n.name),i={},i[t("Rename")]=function(){var t=$.trim($("#txtFileName").val());t?n.Rename(t)&&($('li[data-path="'+n.fullPath+'"] .name').text(t),$('li[data-path="'+n.fullPath+'"]').attr("data-path",RoxyUtils.MakePath(n.path,t)),$("#pnlRenameFile").dialog("close")):alert("Missing file name")},i[t("Cancel")]=function(){$("#pnlRenameFile").dialog("close")},$("#pnlRenameFile").dialog({title:t("T_RenameFile"),modal:!0,buttons:i}),n.name.lastIndexOf(".")>0&&RoxyUtils.SelectText("txtFileName",0,n.name.lastIndexOf(".")))}function getSelectedFile(){var n=null;return $("#pnlFileList .selected").length>0&&(n=new File($("#pnlFileList .selected").attr("data-path"))),n}function getSelectedDir(){var n=null;return $("#pnlDirList .selected")&&(n=Directory.Parse($("#pnlDirList .selected").closest("li").attr("data-path"))),n}function deleteDir(n){var i=null;i=n?Directory.Parse(n):getSelectedDir();i&&confirm(t("Q_DeleteFolder"))&&i.Delete()}function deleteFile(){var n=getSelectedFile();n&&confirm(t("Q_DeleteFile"))&&n.Delete()}function previewFile(){var n=getSelectedFile();n&&window.open(n.fullPath)}function downloadFile(){var n=getSelectedFile(),i;n&&RoxyFilemanConf.DOWNLOAD?(i=RoxyUtils.AddParam(RoxyFilemanConf.DOWNLOAD,"f",n.fullPath),window.frames.frmUploadFile.location.href=i):RoxyFilemanConf.DOWNLOAD||alert(t("E_ActionDisabled"))}function downloadDir(){var n=getSelectedDir(),i;n&&RoxyFilemanConf.DOWNLOADDIR?(i=RoxyUtils.AddParam(RoxyFilemanConf.DOWNLOADDIR,"d",n.fullPath),window.frames.frmUploadFile.location.href=i):RoxyFilemanConf.DOWNLOAD||alert(t("E_ActionDisabled"))}function closeMenus(n){n&&n!="dir"||$("#menuDir").fadeOut();n&&n!="file"||$("#menuFile").fadeOut()}function selectFirst(){var n=$("#pnlDirList li:first").children("div").first();n.length>0?selectDir(n):window.setTimeout("selectFirst()",300)}function tooltipContent(){if($("#menuFile").is(":visible"))return"";var i="",n=File.Parse($(this).attr("data-path"));return $("#hdViewType").val()=="thumb"&&n.IsImage()?i=n.fullPath+'<br><span class="filesize">'+t("Size")+": "+RoxyUtils.FormatFileSize(n.size)+" "+t("Dimensions")+": "+n.width+"x"+n.height+"<\/span>":n.IsImage()?(RoxyFilemanConf.GENERATETHUMB?(imgUrl=RoxyUtils.AddParam(RoxyFilemanConf.GENERATETHUMB,"f",n.fullPath),imgUrl=RoxyUtils.AddParam(imgUrl,"width",RoxyFilemanConf.PREVIEW_THUMB_WIDTH),imgUrl=RoxyUtils.AddParam(imgUrl,"height",RoxyFilemanConf.PREVIEW_THUMB_HEIGHT)):imgUrl=n.fullPath,i='<img src="'+imgUrl+'" class="imgPreview"><br>'+n.name+' <br><span class="filesize">'+t("Size")+": "+RoxyUtils.FormatFileSize(n.size)+" "+t("Dimensions")+": "+n.width+"x"+n.height+"<\/span>"):i=n.fullPath+' <span class="filesize">'+t("Size")+": "+RoxyUtils.FormatFileSize(n.size)+"<\/span>",i}function filterFiles(){var t=$("#txtSearch").val(),n;if($("#pnlSearchNoFiles").hide(),$("#pnlFileList li").length!=0){if(!t){$("#pnlFileList li").show();return}n=0;$("#pnlFileList li").each(function(){var i=$(this).children(".name").text();i.toLowerCase().indexOf(t.toLowerCase())>-1?(n++,$(this).show()):($(this).removeClass("selected"),$(this).hide())});n==0&&$("#pnlSearchNoFiles").show()}}function sortFiles(){var n=getSelectedDir();n&&(n.ListFiles(),filterFiles(),switchView($("#hdViewType").val()))}function switchView(n){if(n!=$("#hdViewType").val()){if(n||(n=$("#hdViewType").val()),$(".btnView").removeClass("selected"),n=="thumb"){if($("#pnlFileList .icon").attr("src","images/blank.gif"),$("#pnlFileList").addClass("thumbView"),$("#dynStyle").length==0){$("head").append('<style id="dynStyle" />');var t="ul#pnlFileList.thumbView li{width:"+RoxyFilemanConf.THUMBS_VIEW_WIDTH+"px;}";t+="ul#pnlFileList.thumbView li{height:"+(parseInt(RoxyFilemanConf.THUMBS_VIEW_HEIGHT)+20)+"px;}";t+="ul#pnlFileList.thumbView .icon{width:"+RoxyFilemanConf.THUMBS_VIEW_WIDTH+"px;}";t+="ul#pnlFileList.thumbView .icon{height:"+RoxyFilemanConf.THUMBS_VIEW_HEIGHT+"px;}";$("#dynStyle").html(t)}$("#pnlFileList li").each(function(){var n=$(this).attr("data-icon-big");RoxyFilemanConf.GENERATETHUMB&&RoxyUtils.IsImage($(this).attr("data-path"))&&(n=RoxyUtils.AddParam(RoxyFilemanConf.GENERATETHUMB,"f",n),n=RoxyUtils.AddParam(n,"width",RoxyFilemanConf.THUMBS_VIEW_WIDTH),n=RoxyUtils.AddParam(n,"height",RoxyFilemanConf.THUMBS_VIEW_HEIGHT));$(this).children(".icon").css("background-image","url("+n+")");$(this).tooltip("option","show",{delay:50})});$("#btnThumbView").addClass("selected")}else $("#pnlFileList").removeClass("thumbView"),$("#pnlFileList li").each(function(){$(this).children(".icon").css("background-image","").attr("src",$(this).attr("data-icon"));$(this).tooltip("option","show",{delay:500})}),$("#btnListView").addClass("selected");$("#hdViewType").val(n)}}function Clipboard(n,t){this.action=n;this.obj=t}function cutDir(){var n=getSelectedDir();n&&(setClipboard("cut",n),n.GetElement().addClass("pale"))}function copyDir(){var n=getSelectedDir();n&&setClipboard("copy",n)}function cutFile(){var n=getSelectedFile();n&&(setClipboard("cut",n),n.GetElement().addClass("pale"))}function copyFile(){var n=getSelectedFile();n&&setClipboard("copy",n)}function pasteToFiles(n,t){if($(t).hasClass("pale"))return n.stopPropagation(),!1;var i=getSelectedDir();return i||(i=Directory.Parse($("#pnlDirList li:first").children("div").first())),i&&clipBoard&&clipBoard.obj&&(clipBoard.action=="copy"?clipBoard.obj.Copy(i.fullPath):(clipBoard.obj.Move(i.fullPath),clearClipboard())),!0}function pasteToDirs(n,t){if($(t).hasClass("pale"))return n.stopPropagation(),!1;var i=getSelectedDir();return i||(i=Directory.Parse($("#pnlDirList li:first").children("div").first())),clipBoard&&i?clipBoard.action=="copy"?clipBoard.obj.Copy(i.fullPath):(clipBoard.obj.Move(i.fullPath),clearClipboard(),i.ListFiles(!0)):alert("error"),!0}function clearClipboard(){$("#pnlDirList li").removeClass("pale");$("#pnlFileList li").removeClass("pale");clipBoard=null;$(".paste").addClass("pale")}function setClipboard(n,t){clearClipboard();t&&(clipBoard=new Clipboard(n,t),$(".paste").removeClass("pale"))}function ResizeLists(){var n=$(window).innerHeight()-$("#fileActions .actions").outerHeight()-$(".bottomLine").outerHeight();$(".scrollPane").css("height",n)}function setFile(){var i=getSelectedFile(),r,u,n;if(!i){alert(t("E_NoFileSelected"));return}r=RoxyUtils.GetUrlParam("integration");r||(r=RoxyFilemanConf.INTEGRATION);switch(r.toLowerCase()){case"ckeditor":window.opener.CKEDITOR.tools.callFunction(RoxyUtils.GetUrlParam("CKEditorFuncNum"),i.fullPath);self.close();break;case"tinymce3":u=i.fullPath;n=tinyMCEPopup.getWindowArg("window");n.document.getElementById(tinyMCEPopup.getWindowArg("input")).value=u;typeof n.ImageDialog!="undefined"&&(n.ImageDialog.getImageData&&n.ImageDialog.getImageData(),n.ImageDialog.showPreviewImage&&n.ImageDialog.showPreviewImage(u));tinyMCEPopup.close();break;case"tinymce4":n=window.opener?window.opener:window.parent;n.document.getElementById(RoxyUtils.GetUrlParam("input")).value=i.fullPath;typeof n.ImageDialog!="undefined"&&(n.ImageDialog.getImageData&&n.ImageDialog.getImageData(),n.ImageDialog.showPreviewImage&&n.ImageDialog.showPreviewImage(i.fullPath));n.tinyMCE.activeEditor.windowManager.close();break;default:FileSelected(i)}}var clipBoard=null;$(function(){RoxyUtils.LoadConfig();var n=new Directory;n.LoadAll();$("#wraper").show();window.setTimeout("selectFirst()",300);RoxyUtils.Translate();$("body").click(function(){closeMenus()});RoxyFilemanConf.DEFAULTVIEW&&switchView(RoxyFilemanConf.DEFAULTVIEW);ResizeLists();$(".actions input").tooltip({track:!0});$(window).resize(ResizeLists);RoxyFilemanConf.INTEGRATION.toLowerCase()=="tinymce3"&&$("body").append('<script src="js/tiny_mce_popup.js"><\/script>');document.oncontextmenu=function(){return!1};$("#copyYear").html((new Date).getFullYear())});
//# sourceMappingURL=main.min.js.map
